<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="mapper.mypage">
	<resultMap type="myReviewDTO" id="MyreviewResult">
		<result property="re_no" column="re_no"></result>
		<result property="re_score" column="re_score"></result>
		<result property="re_content" column="re_content"></result>
		<result property="re_writeDate" column="re_writeDate"></result>
		<result property="re_img" column="re_img"></result>
		<result property="id" column="id"></result>
		<result property="lod_no" column="lod_no"></result>
		<result property="act_no" column="act_no"></result>
		<result property="fd_no" column="fd_no"></result>
		<result property="tr_no" column="tr_no"></result>
	</resultMap>
	
	<select id="reviewList" resultType="com.spring.project.mypage.dto.ReviewDTO">
		<![CDATA[
			select r.*, f.fd_title||l.lod_title||a.ac_title||t.tr_title as title from review r,food f, lodging_list l, activity a, tour t
   	 		where (r.fd_no = f.fd_no(+) and r.lod_id = l.lod_id(+) and r.ac_no = a.ac_no(+) and r.tr_no = t.tr_no(+)) and r.id=#{id}
		]]> 
	</select>
	
	<resultMap type="myReservationDTO" id="MyreservationResult">
		<result property="air_no" column="air_no"></result>
		<result property="air_airline" column="air_airline"></result>
		<result property="air_date" column="air_date"></result>
		<result property="air_departTime" column="air_departTime"></result>
		<result property="air_arrivalTime" column="air_arrivalTime"></result>
		<result property="air_departPlace" column="air_departPlace"></result>
		<result property="air_arrivalPlace" column="air_arrivalPlace"></result>
		<result property="air_price" column="air_price"></result>
		<result property="id" column="id"></result>
		<result property="name" column="name"></result>
		<result property="birth" column="birth"></result>
		<result property="payment" column="payment"></result>
	</resultMap>
	
	<select id="reservationcheck" resultType="com.spring.project.mypage.dto.MyReservationDTO">
		<![CDATA[
			select * from airplane_res where id=#{id}
		]]>
	</select>
	
	<resultMap type="lodReservationDTO" id="lodreservationResult">
		<result property="lod_id" column="lod_id"></result>
		<result property="id" column="id"></result>
		<result property="res_name" column="res_name"></result>
		<result property="res_tel" column="res_tel"></result>
		<result property="lod_title" column="lod_title"></result>
		<result property="r_title" column="r_title"></result>
		<result property="lod_checkIn" column="lod_checkIn"></result>
		<result property="lod_checkOut" column="lod_checkOut"></result>
		<result property="res_from" column="res_from"></result>
		<result property="res_to" column="res_to"></result>
		<result property="payment" column="payment"></result>
		<result property="price" column="price"></result>
	</resultMap>
	
	<select id="lodreservationcheck" resultType="lodReservationDTO">
		<![CDATA[
			select * from lodging_res where id=#{id}
		]]>
	</select>
	
	<resultMap type="travleDTO" id="travleResult">
		<result property="id" column="id"></result>
		<result property="year" column="year"></result>
		<result property="month" column="month"></result>
		<result property="day" column="day"></result>
		<result property="schedule" column="schedule"></result>
		<result property="scheduleDetail" column="scheduleDetail"></result>
		<result property="fd_no" column="fd_no"></result>
		<result property="lod_id" column="lod_id"></result>
		<result property="ac_no" column="ac_no"></result>
		<result property="tr_no" column="tr_no"></result>
	</resultMap>
	
	<select id="travlecheck" resultType="travleDTO">
		<![CDATA[
			select m.*, f.fd_title||l.lod_title||a.ac_title||t.tr_title as title from mypick m,food f, lodging_list l, activity a, tour t
   			 where  (m.fd_no = f.fd_no(+) and m.lod_id = l.lod_id(+) and m.ac_no = a.ac_no(+) and m.tr_no = t.tr_no(+))  and m.id=#{id}
		]]>
	</select>
	
	<insert id="insertTravle" parameterType="travleDTO">
		<![CDATA[
			insert into schedule values(#{id}, #{year}, #{month}, #{day}, #{schedule}, #{scheduleDetail}, #{fd_no}, #{lod_id},
			#{ac_no}, #{tr_no})
		]]>
	</insert>
	
	<update id="updateTravle" parameterType="travleDTO">
		<![CDATA[
			update schedule set id=#{id}, year=#{year}, month=#{month}, day=#{day}, schedule=#{schedule}
			, scheduleDetail=#{scheduleDetail}, fd_no=#{fd_no}, #lod_id=#{lod_id}, ac_no=#{ac_no}, tr_no=#{tr_no} where id=#{id}
		]]>
	</update>
	
	<delete id="deleteTravle" parameterType="String">
		<![CDATA[
			delete from schedule where id=#{id}
		]]>
	</delete>
	
	
	<delete id="reviewDel" parameterType="int">
		<![CDATA[
			delete from review where re_no=#{re_no}
		]]>
	</delete>
	
</mapper>